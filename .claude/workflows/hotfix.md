# Workflow: Hotfix

긴급 수정 워크플로우. 프로덕션 장애 대응.

---

## 개요

| 항목 | 내용 |
|------|------|
| **목적** | 프로덕션 긴급 수정 |
| **사용 시점** | 서비스 장애, Critical 버그 |
| **핵심 원칙** | 속도 우선, 검수 간소화 |

---

## ⚠️ 사용 조건

**Hotfix는 다음 경우에만 사용:**
- 서비스 중단
- 데이터 손실 위험
- 결제/인증 등 핵심 기능 마비
- 보안 취약점

**일반 버그는 `bug-fix` 워크플로우 사용**

---

## 단계별 흐름

```
Step 1: 긴급 대응 (15분 이내)
    CEO → planner → 담당 Agent
    
Step 2: 수정 & 배포 (최대한 빠르게)
    frontend-dev / backend-dev → devops
    
Step 3: 사후 검증 (배포 후)
    qa-engineer → reviewer
```

---

## Step 1: 긴급 대응

### 1.1 장애 접수

**planner 작업:**
```markdown
## 🚨 HOTFIX 시작

### 장애 상황
- 시간: {발생 시간}
- 증상: {증상}
- 영향: {영향 범위}
- 심각도: Critical

### 긴급 할당
- 담당: @{frontend-dev / backend-dev}
- 우선순위: 최우선 (다른 작업 중단)

즉시 대응 부탁드립니다.
```

### 1.2 원인 빠른 파악

**담당 Agent 작업:**
- 에러 로그 확인
- 최근 배포 확인
- 원인 빠르게 특정

---

## Step 2: 수정 & 배포

### 2.1 긴급 수정

**frontend-dev / backend-dev 작업:**
- 최소한의 수정
- 근본 해결보다 **증상 해결** 우선
- 로컬 테스트

### 2.2 긴급 배포

**devops 작업:**
- Staging 스킵 가능 (CEO 승인 시)
- Production 직접 배포
- 배포 후 즉시 모니터링

```markdown
@CEO 긴급 배포 승인 요청

- 수정 내용: {내용}
- 위험도: {낮음/중간/높음}
- Staging 스킵: 예/아니오

승인 시 즉시 Production 배포합니다.
```

### 2.3 복구 확인

**planner 작업:**
```markdown
## 🟢 서비스 복구 확인

- 복구 시간: {시간}
- 수정 내용: {내용}
- 현재 상태: 정상

사후 검증 진행합니다.
```

---

## Step 3: 사후 검증

### 3.1 QA 검증 (배포 후)

**qa-engineer 작업:**
- 수정 사항 검증
- 회귀 테스트
- 추가 이슈 확인

### 3.2 코드 검수 (배포 후)

**reviewer 작업:**
- 긴급 수정 코드 검토
- 개선 필요 사항 기록
- 기술 부채 문서화

### 3.3 사후 분석

**planner 작업:**
```markdown
## Hotfix 사후 분석

### 장애 요약
- 발생: {시간}
- 복구: {시간}
- 총 장애 시간: {시간}

### 원인
{근본 원인}

### 수정 내용
{수정 내용}

### 재발 방지
- [ ] {재발 방지 조치 1}
- [ ] {재발 방지 조치 2}

### 후속 작업 (기술 부채)
- [ ] {코드 개선 필요 사항}
- [ ] {테스트 추가 필요}
```

---

## 체크리스트

### 긴급 대응
- [ ] 장애 상황 파악
- [ ] 담당자 즉시 할당
- [ ] CEO 인지

### 수정 & 배포
- [ ] 원인 파악
- [ ] 최소한의 수정
- [ ] CEO 승인 (Staging 스킵 시)
- [ ] 배포 완료
- [ ] 복구 확인

### 사후 검증
- [ ] QA 검증
- [ ] 코드 검수
- [ ] 사후 분석 문서화
- [ ] 재발 방지 조치 계획

---

## 주의사항

1. **최소한의 수정** — 관련 없는 변경 포함 금지
2. **롤백 준비** — 수정이 더 문제면 즉시 롤백
3. **기록 필수** — 모든 과정 기록 (사후 분석용)
4. **사후 정리** — Hotfix 코드는 나중에 정리 필요

---

## 롤백 절차

수정이 오히려 문제를 악화시킬 경우:

```markdown
## 🔴 롤백 실행

1. Vercel Dashboard → Deployments
2. 이전 정상 배포 찾기
3. "Promote to Production" 클릭
4. 롤백 완료 확인

롤백 후 다시 원인 분석 진행.
```